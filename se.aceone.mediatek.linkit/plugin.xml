<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
	<extension point="org.eclipse.ui.newWizards">
		<category 
			id="se.aceone.mediatek.linkit.newWizards"
			name="Mediatek">
		</category>
		<wizard
        canFinishEarly="false"
        category="se.aceone.mediatek.linkit.newWizards"
        class="se.aceone.mediatek.linkit.ui.NewLinkitProjectWizard"
        finalPerspective="org.eclipse.cdt.ui.CPerspective"
        icon="icons/16px-Nuvola_devices_ksim_cpu.png"
        id="se.aceone.mediatek.linkit.NewLinkitProjectWizard"
        name="New LinkIt Project"
        project="true">
         <description>
            %wizard.description
         </description>	        
		</wizard>
	</extension>
   <extension
         id="se.aceone.mediatek.linkit.buildDefinitions"
         name="Mediatek LinkIt Tool Chain"
         point="org.eclipse.cdt.managedbuilder.core.buildDefinitions">
         		<builder
        autoBuildTarget="all"
        buildfileGenerator="se.aceone.mediatek.linkit.toolchain.LinkItGnuMakefileGenerator"
        cleanBuildTarget="clean"
        command="make"
        errorParsers="org.eclipse.cdt.core.MakeErrorParser"
        id="se.aceone.mediatek.linkit.gnu.builder"
        ignoreErrCmd="-k"
        incrementalBuildTarget="all"
        isAbstract="true"
        isVariableCaseSensitive="false"
        macroInputDirRelPathValue="$(dir $&lt;)"
        macroInputFileBaseNameValue="$(basename $(notdir $&lt;))"
        macroInputFileExtValue="$(suffix $(notdir $&lt;))"
        macroInputFileNameValue="$(notdir $&lt;)"
        macroInputFileRelPathValue="$&lt;"
        macroOutputDirRelPathValue="$(dir $@)"
        macroOutputFileBaseNameValue="$(basename (notdir $@))"
        macroOutputFileExtValue="$(suffix $(notdir $@)"
        macroOutputFileNameValue="$(notdir $@)"
        macroOutputFileRelPathValue="$@"
        name="Mediatek LinkIt GNU Builder"
        parallelBuildCmd="-j*"
        reservedMacroNames="ROOT,DEPS,OBJS,.*_SRCS,EXECUTABLES,SUBDIRS,LIBS,USER_OBJS,.*_INPUTS,.*_OUTPUTS"
        variableFormat="${=}">
  </builder>
      <projectType
            id="se.aceone.mediatek.linkit.projectType"
            isAbstract="false"
            name="Mediatek LinkIt">
         <configuration
               artifactExtension="vxp"
               cleanCommand="rm -f"
               id="se.aceone.mediatek.linkit.configuration"
               name="Default">
        <toolChain
              archList="all"
              id="se.aceone.mediatek.linkit.toolChain.default"
              isAbstract="false"
              name="LinkIt Tool Chain"
              osList="all"
              targetTool="se.aceone.mediatek.linkit.tool.size">
           <targetPlatform
                 archList="all"
                 binaryParser="org.eclipse.cdt.core.ELF"
                 id="se.aceone.mediatek.linkit.targetplatform"
                 name="LinkIt Target"
                 osList="all">
           </targetPlatform>
           <builder
                 id="se.aceone.mediatek.linkit.builder"
                 isVariableCaseSensitive="false"
                 name="LinkIt Builder"
                 reservedMacroNames="LinkItSDK20"
                 superClass="se.aceone.mediatek.linkit.gnu.builder">
           </builder>
           <optionCategory
                 id="se.aceone.mediatek.linkit.optionCategory.includePaths"
                 name="Include Folders">
           </optionCategory>
           <tool
                 announcement="Starting C++ compile"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${GCCCPPCOMPILER}"
                 commandLinePattern="${COMMAND} ${GCCTCCCOMPILER} ${FLAGS} ${OUTPUT_FLAG} ${OUTPUT_PREFIX} -o ${OUTPUT} -c ${INPUTS}"
                 errorParsers="org.eclipse.cdt.core.GCCErrorParser"
                 id="se.aceone.mediatek.linkit.compiler.cpp"
                 name="C++ Compiler"
                 natureFilter="both">
              <optionCategory
                    id="se.aceone.mediatek.linkit.cpp.optionCategory.includePaths"
                    name="Include Path">
              </optionCategory>
              <option
                    browseType="directory"
                    category="se.aceone.mediatek.linkit.cpp.optionCategory.includePaths"
                    command="-I"
                    id="se.aceone.mediatek.linkit.compiler.cpp.option.incpath"
                    name="C++ Include Path"
                    resourceFilter="project"
                    valueType="includePath">
              </option>
              <optionCategory
                    id="se.aceone.mediatek.linkit.cpp.optionCategory.macros"
                    name="Macros">
              </optionCategory>
              <option
                    browseType="none"
                    category="se.aceone.mediatek.linkit.cpp.optionCategory.macros"
                    command="-D"
                    id="se.aceone.mediatek.linkit.compiler.cpp.option.macros"
                    name="C++ Macros"
                    resourceFilter="project"
                    valueType="definedSymbols">
              </option>
              <inputType
                    buildVariable="CPP_SKETCH_FILES"
                    dependencyCalculator="se.aceone.mediatek.linkit.toolchain.LinkItDependencyCalculator"
                    dependencyContentType="org.eclipse.cdt.core.cxxHeader"
                    id="se.aceone.mediatek.linkit.input"
                    name="C++ Source"
                    primaryInput="true"
                    sourceContentType="org.eclipse.cdt.core.cxxSource">
              </inputType>
              <outputType
                    buildVariable="LINK_OBJ"
                    id="se.aceone.mediatek.linkit.link.output"
                    name="C++ Link Object"
                    nameProvider="se.aceone.mediatek.linkit.toolchain.LinkNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
<!--
              <outputType
                    buildVariable="AR_OBJ"
                    id="se.aceone.mediatek.linkit.compiler.cpp.ar.output"
                    name="C++ AR Object"
                    nameProvider="se.aceone.mediatek.linkit.ArchiveNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
    -->       </tool>
           <tool
                 announcement="Starting C compile"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${GCCCCOMPILER}"
                 commandLinePattern="${COMMAND} ${GCCCOMPILER} ${FLAGS} ${OUTPUT_FLAG} ${OUTPUT_PREFIX} -o ${OUTPUT} -c ${INPUTS}"
                 errorParsers="org.eclipse.cdt.core.GCCErrorParser"
                 id="se.aceone.mediatek.linkit.compiler.c"
                 name="C Compiler"
                 natureFilter="both">
              <optionCategory
                    id="se.aceone.mediatek.linkit.c.optionCategory.includePaths"
                    name="Include Path">
              </optionCategory>
              <option
                    browseType="directory"
                    category="se.aceone.mediatek.linkit.c.optionCategory.includePaths"
                    command="-I"
                    id="se.aceone.mediatek.linkit.compiler.c.option.incpath"
                    name="C Include Path"
                    resourceFilter="project"
                    valueType="includePath">
              </option>
              <optionCategory
                    id="se.aceone.mediatek.linkit.c.optionCategory.macros"
                    name="Macros">
              </optionCategory>
              <option
                    browseType="none"
                    category="se.aceone.mediatek.linkit.c.optionCategory.macros"
                    command="-D"
                    id="se.aceone.mediatek.linkit.compiler.c.option.macros"
                    name="C Macros"
                    resourceFilter="project"
                    valueType="definedSymbols">
              </option>
              <inputType
                    buildVariable="C_SKETCH_FILES"
                    dependencyCalculator="se.aceone.mediatek.linkit.toolchain.LinkItDependencyCalculator"
                    dependencyContentType="org.eclipse.cdt.core.cHeader"
                    id="se.aceone.mediatek.linkit.compiler.c.input"
                    multipleOfType="false"
                    name="C Source"
                    primaryInput="true"
                    sourceContentType="org.eclipse.cdt.core.cSource">
              </inputType>
              <outputType
                    buildVariable="LINK_OBJ"
                    id="se.aceone.mediatek.linkit.compiler.c.link.output"
                    name="C Link Object"
                    nameProvider="se.aceone.mediatek.linkit.toolchain.LinkNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
              <!--
              <outputType
                    buildVariable="AR_OBJ"
                    id="se.aceone.mediatek.linkit.compiler.c.ar.output"
                    name="C AR Object"
                    nameProvider="se.aceone.mediatek.linkit.toolchain.ArchiveNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
              -->
           </tool>
           <!-- 
           <tool
                 announcement="Starting ASM compile"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${ARMARGCC}"
                 commandLinePattern=" ${COMMAND} ${FLAGS} ${OUTPUT_FLAG} ${OUTPUT_PREFIX} ${OUTPUT} ${INPUTS}"
                 errorParsers="org.eclipse.cdt.core.GCCErrorParser"
                 id="se.aceone.mediatek.linkit.compiler.s"
                 name="ASM Compiler"
                 natureFilter="both">
              <inputType
                    buildVariable="S_SKETCH_FILES"
                    dependencyCalculator="se.aceone.mediatek.linkit.toolchain.ArduinoDependencyCalculator"
                    dependencyContentType="org.eclipse.cdt.core.cxxHeader"
                    id="se.aceone.mediatek.linkit.compiler.S.sketch.input"
                    name="ASM Source"
                    primaryInput="true"
                    sourceContentType="org.eclipse.cdt.core.asmSource">
              </inputType>
              <outputType
                    buildVariable="LINK_OBJ"
                    id="se.aceone.mediatek.linkit.compiler.S.sketch.link.output"
                    name="ASM Link Object"
                    nameProvider="se.aceone.mediatek.linkit.toolchain.LinkNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
              <outputType
                    buildVariable="AR_OBJ"
                    id="se.aceone.mediatek.linkit.compiler.S.ar.output"
                    name="ASM AR Object"
                    nameProvider="se.aceone.mediatek.linkit.toolchain.ArchiveNameProvider"
                    outputs="o"
                    primaryOutput="true">
              </outputType>
           </tool>
           -->
           <!--
           <tool
                 announcement="Starting archiver"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${ARMARGCC}"
                 errorParsers="org.eclipse.cdt.core.GLDErrorParser"
                 id="se.aceone.mediatek.linkit.tool.archiver"
                 name="Archiver">
              <outputType
                    buildVariable="AR"
                    id="se.aceone.mediatek.linkit.tool.archiver.output"
                    name="Archiver output"
                    outputNames="${A.ARCHIVE_FILE}"
                    outputs="ar"
                    primaryOutput="true">
              </outputType>
              <inputType
                    assignToOption="A.OBJECT_FILE"
                    buildVariable="AR_OBJ"
                    id="se.aceone.mediatek.linkit.tool.archiver.input"
                    multipleOfType="true"
                    name="Archiver input"
                    primaryInput="false"
                    sources="o">
              </inputType>
           </tool>
           -->
           <tool announcement="Starting Linker"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${GCCLINK}"
                 commandLinePattern="${COMMAND} ${GCCLINKER} -B ${ARMNONEEABITHUMB} -T ${LINKIT10}/${GCCTCCLIB}/scat.ld -o ${OUTPUT} ${INPUTS} ${LINKIT10}/${GCCLIB}/${COMMONLIB}"
                 errorParsers="org.eclipse.cdt.core.GLDErrorParser"
                 id="se.aceone.mediatek.linkit.tool.linker"
                 name="Linker"
                 natureFilter="both">
              <inputType
                    buildVariable="LINK_OBJ"
                    id="se.aceone.mediatek.linkit.tool.linker.ob.input"
                    multipleOfType="true"
                    name="Linker input"
                    primaryInput="true"
                    sources="o">
              </inputType>
              <outputType
                    buildVariable="AXF_DATA"
                    id="se.aceone.mediatek.linkit.tool.linker.data.output"
                    multipleOfType="false"
                    name="Linker output axf"
                    outputNames="${ProjName}.axf"
                    outputs="axf"
                    primaryOutput="true">
              </outputType>
              <outputType
                    buildVariable="DBG"
                    id="se.aceone.mediatek.linkit.tool.linker.dbg.output"
                    multipleOfType="false"
                    name="Linker output debug"
                    outputNames="${ProjName}.axf"
                    outputs="axf"
                    primaryOutput="false">
              </outputType>
<!--
              <outputType
                    buildVariable="ELF"
                    id="se.aceone.mediatek.linkit.tool.linker.output"
                    name="Linker output"
                    outputNames="${ProjName}.axf"
                    outputs="elf"
                    primaryOutput="true">
              </outputType>
          -->
           </tool>
           <tool
                 announcement="Generating AXF data file"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${OBJCOPY}"
                 commandLinePattern="${COMMAND} -g -R .comment  ${INPUTS}  ${OUTPUT} "
                 id="se.aceone.mediatek.linkit.tool.objcopy.dbgdata"
                 isAbstract="false"
                 name="AXF data file"
                 natureFilter="both">
              <inputType
                    buildVariable="AXF_DATA"
                    dependencyExtensions="axf"
                    id="se.aceone.mediatek.linkit.tool.objcopy.data.input"
                    multipleOfType="true"
                    name="AXF data file input"
                    primaryInput="true"
                    sourceContentType="se.aceone.mediatek.linkit.tool.linker.data.output"
                    sources="axf">
              </inputType>
              <outputType
                    buildVariable="AXF_DATA_OUT"
                    id="se.aceone.mediatek.linkit.tool.objcopy.data.output"
                    multipleOfType="false"
                    name="AXFdata file output"
                    outputNames="${ProjName}.out.axf"
                    outputs="out.afx"
                    primaryOutput="true">
              </outputType>
           </tool>
           <tool announcement="Creating debug data only"
                 command="${LINKITSDK20}${GCCLOCATION}/bin/${OBJCOPY}"
                 commandLinePattern="${COMMAND} --only-keep-debug ${INPUTS}  ${OUTPUT} "
                 id="se.aceone.mediatek.linkit.tool.objcopy.dbg"
                 isAbstract="false"
                 name="Debug only data file"
                 natureFilter="both">
              <inputType
                    buildVariable="DBG"
                    dependencyExtensions="axf"
                    id="se.aceone.mediatek.linkit.tool.objcopy.dbg.input"
                    multipleOfType="true"
                    name="Debug data file input"
                    primaryInput="true"
                    sourceContentType="se.aceone.mediatek.linkit.tool.linker.dbg.output"
                    sources="axf">
              </inputType>
              <outputType
                    buildVariable="DBG_DATA"
                    id="se.aceone.mediatek.linkit.tool.objcopy.dbg.output"
                    multipleOfType="false"
                    name="Debug data file output"
                    outputNames="${ProjName}.dbg"
                    outputs="dbg">
              </outputType>
           </tool>
<!--
           <tool
                 announcement="Resource Packer"
                 command="${TOOLPATH}/${RESEDITOR}"
                 commandLinePattern="${COMMAND} pack -silent -resolution 128x160 -o ${OUTPUT} -e AXF -vom ${workspace_loc}/${ProjName}/${ProjName}.proj  ${INPUTS}"
                 id="se.aceone.mediatek.linkit.tool.packer"
                 isAbstract="false"
                 name="Resource Packer"
                 natureFilter="both">
              <inputType
                    buildVariable="ELF"
                    dependencyExtensions="elf"
                    id="se.aceone.mediatek.linkit.tool.packer.input"
                    multipleOfType="true"
                    name="Resource Packer input"
                    primaryInput="true"
                    sourceContentType="se.aceone.mediatek.linkit.tool.linker.output"
                    sources="eep">
              </inputType>
              <outputType
                    buildVariable="RES_PKD"
                    id="se.aceone.mediatek.linkit.tool.packer.output"
                    multipleOfType="false"
                    name="Resource Packer output"
                    namePattern="${ProjName}.pkd"
                    outputNames="${ProjName}.pkd"
                    outputs="pkd">
              </outputType>
           </tool>
    -->       
                <tool announcement="Size command"
                      command="${LINKITSDK20}${GCCLOCATION}/bin/${SIZETOOL}"
                      commandLinePattern="${COMMAND} -A ${INPUTS}"
                      id="se.aceone.mediatek.linkit.tool.size"
                      name="Size">
		              <inputType
		                    buildVariable="AXF_DATA_OUT"
		                    id="se.aceone.mediatek.linkit.tool.size.input"
		                    multipleOfType="false"
		                    name="Size input"
		                    primaryInput="true"
		                    sources="out.axf">
		              </inputType>
		              <inputType
		                    buildVariable="DBG_DATA"
		                    dependencyExtensions="dbg"
		                    id="se.aceone.mediatek.linkit.tool.size.input.dbg"
		                    multipleOfType="true"
		                    name="Size debug input"
		                    primaryInput="false">
		              </inputType>
		               <outputType
		                    buildVariable="SIZEDUMMY"
		                    id="se.aceone.mediatek.linkit.tool.size.output"
		                    multipleOfType="false"
		                    name="Size output"
		                    outputNames="sizedummy"
		                    outputs="${project}.size"
		                    primaryOutput="true">
		              </outputType>
           </tool>
        </toolChain>
         </configuration>
      </projectType>
   </extension>
  <extension
       point="org.eclipse.ui.navigator.navigatorContent">
    <commonWizard
          associatedExtensionId="org.eclipse.cdt.ui.navigator.content"
          menuGroupId="org.eclipse.cdt.ui.newProject"
          type="new"
          wizardId="se.aceone.mediatek.linkit.NewLinkitProjectWizard">
       <enablement>
          <or>
             <with
                   variable="activeWorkbenchWindow.activePerspective">
                <equals
                      value="org.eclipse.cdt.ui.CPerspective">
                </equals>
             </with>
             <instanceof
                   value="org.eclipse.cdt.core.model.ICElement">
             </instanceof>
             <and>
                <instanceof
                      value="org.eclipse.core.resources.IProject">
                </instanceof>
                <test
                      property="org.eclipse.core.resources.projectNature"
                      value="org.eclipse.cdt.core.cnature">
                </test>
             </and>
          </or>
       </enablement>
    </commonWizard>

  </extension>
</plugin>
